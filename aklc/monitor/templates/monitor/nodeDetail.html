{% extends "monitor/webbase.html" %}

{% block title %}
Node Details
{% endblock %}

{% block web-body %}
<div class="iot_background">

  <div id="node-header"><H2>Node information</H2></div>
  <div id="node_detail" class="content_block">
    <div id="node_det_table">
      <table>
        <tr><th>NodeID: </th><th>{{ node.nodeID }}</th></tr>
        <tr><td>Description: </td><td class = "wrap_cell">{{ node.descr }}</td></tr>
        <tr><td>Team: </td><td class="topic">{{ node.team.teamID }}</td></tr>
        {% if node.hardware %}
          <tr><td>Hardware: </td><td>{{ node.hardware }}</td></tr>
        {% endif %}
        {% if node.software %}
          <tr><td>Software: </td><td>{{ node.software }}</td></tr>
        {% endif %}
        {% if node.battName %}
          <tr><td>Battery attribute name: </td><td>{{ node.battName }}</td></tr>
          <tr><td>Battery warning level: </td><td>{{ node.battWarn }}</td></tr>
          <tr><td>Battery critical level: </td><td>{{ node.battCritical }}</td></tr>
          <tr><td>Battery current value: </td><td class="lastseen">{{ node.battLevel }}</td></tr>
        {% endif %}
      </table>
    </div>
    <div id="node_det_button" class="action_button">
      <a href="{% url 'monitor:nodeUpdate' node.id %}" class="btn btn-info" role="button">Update details</a>
    </div>
  </div>
  
  
  <div id="node_notify" class="content_block"> 
    {% if node.nodeuser_set.all %}
      <div id="node_notify_table">
        <table>
          <tr><th>People </th><th>Notification method</th></tr>
          {% for person in node.nodeuser_set.all %}
            <tr><td>{{ person.user.username }}</td>
              <td>
              {% if person.email %} Email {% endif %}
              {% if person.sms %} SMS {% endif %}
              </td>
            </tr>
          {% endfor %}
        </table>
      </div>
    {% else %}
      Nobody is getting notified about this node!<br><br>
    {% endif %}
    <div id="node_notify_button" class="action_button">
      <a href="{% url 'monitor:nodeModNotify' node.id %}" class="btn btn-info" role="button">Change your notification</a>
    </div>
  </div>
  
  
  <div id="node_reported" class="content_block">
      <div id="node_rep_table">
        <table>
          <tr><th>Reported data: </th></tr>
          <tr><td>Current status: </td><td>{{ node.textStatus }}</td></tr>
          <tr><td>Last data: </td><td class = "wrap_cell">{{ node.lastData }}</td></tr>
          <tr><td>Last seen at: </td><td class="lastseen">{{ node.lastseen }}</td></tr>
          {% if node.latitude %} {% if node.longitude %}
            <tr><td>Latitude: </td><td>{{ node.latitude }}</td></tr>
            <tr><td>Longitude: </td><td>{{ node.longitude }}</td></tr>
          {% endif %} {% endif %}
          {% if node.battName %} {% if node.battLevel > 0 %}
            <tr><td>Current battery level: </td><td>{{ node.battLevel }}</td></tr>
          {% endif %} {% endif %} 
          {% if node.RSSI %}
            <tr><td>Last RSSI level: </td><td>{{ node.RSSI }}</td></tr>
          {% endif %}
        </table>
        {% if node.status == 'X' %}
          <div id="node_det_button" class="action_button">
            <a href="{% url 'monitor:nodeRemove' node.id %}" class="btn btn-danger" role="button">Remove</a>
          </div>
        {% endif %}
      </div>
    </div>
 
  
  </div>

  <a href="{% url 'monitor:index' %}" class="btn btn-info" role="button">Home</a>
 
</div>
{% endblock %}